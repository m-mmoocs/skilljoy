<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); // the library download had messed up paths.  this is needed for includes to workset_include_path(str_replace('index.php','application/libraries',$_SERVER['SCRIPT_FILENAME']));require_once("Google/Client.php");require_once("Google/Service/Oauth2.php");require_once("Google/Service/Plus.php");class Gconnect extends Google_Client{	private $ci;	public $oauth2, $plus;		public function __construct(){		parent::__construct();		$this->ci = &get_instance();		// Skilljoy		$this->setApplicationName('Skilljoy');		$this->setClientId('556580795356-eu27kaa22q22fgmf3g7qqfkns5cev0s1.apps.googleusercontent.com');		$this->setClientSecret('Yu4bk2U77YDJL9MlJmzYUcc2');		$this->setRedirectUri('http://localhost/skilljoy/users/g_login');		$this->setDeveloperKey('AIzaSyBKMBFyPpOrtFaelZnsknU373eKRV1GbSw');                $this->addScope(array( 'https://www.googleapis.com/auth/plus.me',                                        'https://www.googleapis.com/auth/userinfo.email',                                        'https://www.googleapis.com/auth/plus.circles.read'));		$this->setApprovalPrompt('auto');                                $this->plus = new Google_Service_Plus($this);		$this->oauth2 = new Google_Service_Oauth2($this);	}		public function getLoginUrl($args){		$this->setRedirectUri($args['redirect_uri']);		return $this->createAuthUrl();	}                 public function my_authenticate($code=NULL){            $this->authenticate($code);            $this->ci->session->set_userdata('google_access_token',$this->getAccessToken());        }                public function get_userinfo(){            $this->setAccessToken($this->ci->session->userdata('google_access_token'));            $user = $this->plus->people->get('me');            echo "<pre>".print_r($user->data,true)."</pre>"; die;            $user['email']=$user['emails'][0]['value'];            return $user;        }                public function get_friends_list(){//            if($this->isAccessTokenExpired()){////                $this->setAccessToken($this->ci->session->userdata('google_access_token'));//                echo 'expired';//                $token = json_decode($this->getAccessToken());//                $attributes = $this->verifyIdToken($token->id_token, CLIENT_ID)//                ->getAttributes();////                print_r($attributes); die;//            }else{//                echo 'not expired';//                $token = json_decode($this->getAccessToken());//                $attributes = $this->verifyIdToken($token->id_token, CLIENT_ID)//                ->getAttributes();////                print_r($attributes); die;//            }            //            die;//            $out = $this->getAccessToken();//            print_r($out);            $this->setAccessToken($this->ci->session->userdata('google_access_token'));                        $people = $this->plus->people->list(array('userId'=>'me','collection'=>'visible'));            return $people;        }}