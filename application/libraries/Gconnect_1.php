<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed'); require_once("g_client/Google_Client.php");require_once("g_client/contrib/Google_PlusService.php");require_once("g_client/contrib/Google_Oauth2Service.php");define('CLIENT_ID','556580795356-eu27kaa22q22fgmf3g7qqfkns5cev0s1.apps.googleusercontent.com');class Gconnect extends Google_Client{	private $ci;	public $oauth2, $plus;		public function __construct(){		parent::__construct();		$this->ci = &get_instance();		// Skilljoy		$this->setApplicationName('Skilljoy');		$this->setClientId('556580795356-eu27kaa22q22fgmf3g7qqfkns5cev0s1.apps.googleusercontent.com');		$this->setClientSecret('Yu4bk2U77YDJL9MlJmzYUcc2');		$this->setRedirectUri('http://localhost/skilljoy/users/g_login');		$this->setDeveloperKey('AIzaSyBKMBFyPpOrtFaelZnsknU373eKRV1GbSw');		$this->setScopes(array( 'https://www.googleapis.com/auth/plus.me',                                        'https://www.googleapis.com/auth/userinfo.email',                                        'https://www.googleapis.com/auth/plus.circles.read'));		$this->setApprovalPrompt('auto');                                $this->plus = new Google_PlusService($this);		$this->oauth2 = new Google_Oauth2Service($this);	}		public function getLoginUrl($args){		// print_r($args); die;		$this->setRedirectUri($args['redirect_uri']);		return $this->createAuthUrl();	}                 public function my_authenticate($code=NULL){            $this->authenticate($code);                        $this->ci->session->set_userdata('google_access_token',$this->getAccessToken());        }                public function get_userinfo(){            $this->setAccessToken($this->ci->session->userdata('google_access_token'));            $user = $this->plus->people->get('me');            $user['email']=$user['emails'][0]['value'];            return $user;        }                public function get_friends_list(){//            if($this->isAccessTokenExpired()){////                $this->setAccessToken($this->ci->session->userdata('google_access_token'));//                echo 'expired';//                $token = json_decode($this->getAccessToken());//                $attributes = $this->verifyIdToken($token->id_token, CLIENT_ID)//                ->getAttributes();////                print_r($attributes); die;//            }else{//                echo 'not expired';//                $token = json_decode($this->getAccessToken());//                $attributes = $this->verifyIdToken($token->id_token, CLIENT_ID)//                ->getAttributes();////                print_r($attributes); die;//            }            //            die;//            $out = $this->getAccessToken();//            print_r($out);            $this->setAccessToken($this->ci->session->userdata('google_access_token'));                        $people = $this->plus->people->list(array('userId'=>'me','collection'=>'visible'));            return $people;        }}